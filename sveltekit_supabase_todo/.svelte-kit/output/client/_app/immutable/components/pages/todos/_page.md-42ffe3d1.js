import{S as se,i as oe,s as ae,k as y,a as A,q as N,l as T,m as I,c as M,r as U,h,n as p,b as $,D as c,M as Y,I as S,u as J,U as _e,B as Q,J as ne,H as pe,o as he,V as Z,W as me,P as R,w as re,x as ie,y as de,Q as be,R as ge,f as ue,t as ce,z as fe,T as x}from"../../../chunks/index-49ed38d8.js";import{L as ve}from"../../../chunks/LayoutDefault-4d43e17e.js";import{p as ke}from"../../../chunks/stores-a1cd6584.js";import{a as z}from"../../../chunks/supabaseClient-b2c95310.js";function ee(u,e,t){const s=u.slice();return s[16]=e[t],s}function te(u){let e,t;return{c(){e=y("li"),t=N("Nothing to do here!")},l(s){e=T(s,"LI",{});var d=I(e);t=U(d,"Nothing to do here!"),d.forEach(h)},m(s,d){$(s,e,d),c(e,t)},p:Q,d(s){s&&h(e)}}}function le(u,e){let t,s,d,o,n=e[16].task+"",_,w,E,g,k,D,m,f,V,O,q,i,b,a,l,r;function v(){return e[8](e[16])}function B(){return e[9](e[16])}function H(){return e[10](e[16])}return{key:u,first:null,c(){t=y("li"),s=y("div"),d=y("div"),o=y("label"),_=N(n),E=A(),g=y("div"),k=y("button"),D=N("Complete"),m=A(),f=y("button"),V=N("Cancel Complete"),O=A(),q=y("button"),i=N("Delete"),b=A(),this.h()},l(C){t=T(C,"LI",{class:!0,id:!0});var L=I(t);s=T(L,"DIV",{class:!0});var j=I(s);d=T(j,"DIV",{class:!0});var W=I(d);o=T(W,"LABEL",{for:!0,class:!0});var F=I(o);_=U(F,n),F.forEach(h),W.forEach(h),E=M(j),g=T(j,"DIV",{class:!0});var P=I(g);k=T(P,"BUTTON",{type:!0,class:!0});var G=I(k);D=U(G,"Complete"),G.forEach(h),m=M(P),f=T(P,"BUTTON",{type:!0,class:!0});var K=I(f);V=U(K,"Cancel Complete"),K.forEach(h),O=M(P),q=T(P,"BUTTON",{type:!0,class:!0});var X=I(q);i=U(X,"Delete"),X.forEach(h),P.forEach(h),j.forEach(h),b=M(L),L.forEach(h),this.h()},h(){p(o,"for",w="todo-"+e[16].id),p(o,"class","todo-label svelte-1r2fpxu"),Z(o,"done",e[16].is_complete),p(d,"class","c-cb"),p(k,"type","button"),p(k,"class","btn"),p(f,"type","button"),p(f,"class","btn"),p(q,"type","button"),p(q,"class","btn btn__danger"),p(g,"class","btn-group"),p(s,"class","stack-small"),p(t,"class","todo"),p(t,"id",a=e[16].id),this.first=t},m(C,L){$(C,t,L),c(t,s),c(s,d),c(d,o),c(o,_),c(s,E),c(s,g),c(g,k),c(k,D),c(g,m),c(g,f),c(f,V),c(g,O),c(g,q),c(q,i),c(t,b),l||(r=[S(k,"click",v),S(f,"click",B),S(q,"click",H)],l=!0)},p(C,L){e=C,L&1&&n!==(n=e[16].task+"")&&J(_,n),L&1&&w!==(w="todo-"+e[16].id)&&p(o,"for",w),L&1&&Z(o,"done",e[16].is_complete),L&1&&a!==(a=e[16].id)&&p(t,"id",a)},d(C){C&&h(t),l=!1,ne(r)}}}function ye(u){let e,t,s,d,o,n,_,w,E,g,k,D,m,f=[],V=new Map,O,q,i=u[0];const b=l=>l[16].id;for(let l=0;l<i.length;l+=1){let r=ee(u,i,l),v=b(r);V.set(v,f[l]=le(v,r))}let a=null;return i.length||(a=te()),{c(){e=y("div"),t=y("input"),s=A(),d=y("button"),o=N("Add"),n=A(),_=y("h2"),w=N(u[2]),E=N(" out of "),g=N(u[1]),k=N(" items completed"),D=A(),m=y("ul");for(let l=0;l<f.length;l+=1)f[l].c();a&&a.c(),this.h()},l(l){e=T(l,"DIV",{});var r=I(e);t=T(r,"INPUT",{type:!0,placeholder:!0}),s=M(r),d=T(r,"BUTTON",{});var v=I(d);o=U(v,"Add"),v.forEach(h),r.forEach(h),n=M(l),_=T(l,"H2",{id:!0});var B=I(_);w=U(B,u[2]),E=U(B," out of "),g=U(B,u[1]),k=U(B," items completed"),B.forEach(h),D=M(l),m=T(l,"UL",{class:!0,"aria-labelledby":!0});var H=I(m);for(let C=0;C<f.length;C+=1)f[C].l(H);a&&a.l(H),H.forEach(h),this.h()},h(){p(t,"type","text"),p(t,"placeholder","TODO를 입력해주세요."),p(_,"id","list-heading"),p(m,"class","todo-list stack-large"),p(m,"aria-labelledby","list-heading")},m(l,r){$(l,e,r),c(e,t),Y(t,u[3]),c(e,s),c(e,d),c(d,o),$(l,n,r),$(l,_,r),c(_,w),c(_,E),c(_,g),c(_,k),$(l,D,r),$(l,m,r);for(let v=0;v<f.length;v+=1)f[v].m(m,null);a&&a.m(m,null),O||(q=[S(t,"input",u[7]),S(d,"click",u[4])],O=!0)},p(l,[r]){r&8&&t.value!==l[3]&&Y(t,l[3]),r&4&&J(w,l[2]),r&2&&J(g,l[1]),r&97&&(i=l[0],f=_e(f,r,b,1,l,i,V,m,me,le,null,ee),!i.length&&a?a.p(l,r):i.length?a&&(a.d(1),a=null):(a=te(),a.c(),a.m(m,null)))},i:Q,o:Q,d(l){l&&h(e),l&&h(n),l&&h(_),l&&h(D),l&&h(m);for(let r=0;r<f.length;r+=1)f[r].d();a&&a.d(),O=!1,ne(q)}}}function Te(u,e,t){let s;pe(u,ke,i=>t(11,s=i));let d=s.data.session,{user:o={}}=d,n=[{}],_=0,w=null;he(()=>{g()});let E="",g=async()=>{const{data:i,error:b,status:a}=await z.from("todos").select("*").eq("user_id",o.id);if(t(0,n=i),t(1,_=n.length),t(2,w=n.filter(l=>l.is_complete).length),console.log("todos",n),b&&a!==406)throw b},k=async()=>{let i={task:E,description:"",user_id:o.id};const{data:b,error:a,status:l}=await z.from("todos").insert(i).eq("user_id",o.id).select();if(console.log("data",b),a&&l!==406)throw a;b&&t(0,n=[...n,b[0]]),console.log("todos",n),t(3,E="")},D=async(i,b)=>{console.log("update",i);const{data:a,error:l,status:r}=await z.from("todos").update({...b}).eq("id",i).eq("user_id",o.id).select();if(a){let v=n.findIndex(B=>B.id===a[0].id);t(0,n[v]=a[0],n)}if(console.log("data",a),l&&r!==406)throw l},m=async i=>{console.log("delete",i);const{data:b,error:a,status:l}=await z.from("todos").delete().eq("id",i).eq("user_id",o.id).select();if(b){let r=n.findIndex(v=>v.id===b[0].id);n.splice(r,1)}if(t(0,n),a&&l!==406)throw a};function f(){E=this.value,t(3,E)}return[n,_,w,E,k,D,m,f,i=>{D(i.id,{is_complete:!0})},i=>{D(i.id,{is_complete:!1})},i=>{m(i.id)}]}class Ee extends se{constructor(e){super(),oe(this,e,Te,ye,ae,{})}}function Ie(u){let e,t;return e=new Ee({}),{c(){re(e.$$.fragment)},l(s){ie(e.$$.fragment,s)},m(s,d){de(e,s,d),t=!0},i(s){t||(ue(e.$$.fragment,s),t=!0)},o(s){ce(e.$$.fragment,s),t=!1},d(s){fe(e,s)}}}function we(u){let e,t;const s=[u[0]];let d={$$slots:{default:[Ie]},$$scope:{ctx:u}};for(let o=0;o<s.length;o+=1)d=R(d,s[o]);return e=new ve({props:d}),{c(){re(e.$$.fragment)},l(o){ie(e.$$.fragment,o)},m(o,n){de(e,o,n),t=!0},p(o,[n]){const _=n&1?be(s,[ge(o[0])]):{};n&2&&(_.$$scope={dirty:n,ctx:o}),e.$set(_)},i(o){t||(ue(e.$$.fragment,o),t=!0)},o(o){ce(e.$$.fragment,o),t=!1},d(o){fe(e,o)}}}function De(u,e,t){return u.$$set=s=>{t(0,e=R(R({},e),x(s)))},e=x(e),[e]}class Ue extends se{constructor(e){super(),oe(this,e,De,we,ae,{})}}export{Ue as default};
